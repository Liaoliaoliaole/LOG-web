<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<link href="../External_components/tabulator/dist/css/tabulator.css" rel="stylesheet">
<link rel="shortcut icon" type="image/x-icon" href="/art/Morfeas_logo_yellow.ico"/>
<title>Morfeas WEB ISOChannels Linker</title>
</head>
<body>
<div id="opcua_config_table"></div>
<footer id="footer">
	<div style="float:left;">
		Author: Sam Harry Tzavaras &#169; 12021-12022<br>
		<a href="../LICENSE">License: AGPLv3</a>
	</div>
</footer>
</body>
<script src='../morfeas_ecma/common.js'></script>
<script src='../morfeas_ecma/morfeas_web_if.js'></script>
<script src="../External_components/tabulator/dist/js/tabulator.js"></script>
<script>
//@license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-v3.0
/*
@licstart  The following is the entire license notice for the
JavaScript code in this page.

Copyright (C) 12019-12021  Sam Harry Tzavaras

The JavaScript code in this page is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU AGPL) as published by the Free Software
Foundation, either version 3 of the License, or any later version.
The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.

@licend  The above is the entire license notice
for the JavaScript code in this page.
*/
"use strict";
comp_check();
const mode_enum = {
	opcua_config: 0,
	logstats: 1
};

//Global Vars.
var data_req=false, curr_opcua_config,
	request_mode = mode_enum.opcua_config;
/*
var tabledata = [
	{id:1, name:"Oli Bob", age:"12", col:"red", dob:""},
	{id:2, name:"Mary May", age:"1", col:"blue", dob:"14/05/1982"},
	{id:3, name:"Christine Lobowski", age:"42", col:"green", dob:"22/05/1982"},
	{id:4, name:"Brendon Philips", age:"125", col:"orange", dob:"01/08/1980"},
	{id:5, name:"Margret Marmajuke", age:"16", col:"yellow", dob:"31/01/1999"},
];
var opcua_config_table = new Tabulator("#opcua_config_table", {
 	height:205, // set height of table (in CSS or here), this enables the Virtual DOM and improves render speed dramatically (can be any valid css height value)
 	data:tabledata, //assign data to table
 	layout:"fitColumns", //fit columns to width of table (optional)
 	columns:[ //Define Table Columns
	 	{title:"Name", field:"name", width:150},
	 	{title:"Age", field:"age", hozAlign:"left", formatter:"progress"},
	 	{title:"Favourite Color", field:"col"},
	 	{title:"Date Of Birth", field:"dob", sorter:"date", hozAlign:"center"},
 	],
 	rowClick:function(e, row){ //trigger an alert message when the row is clicked
 		alert("Row " + row.getData().id + " Clicked!!!!");
 	},
});
*/
//AJAX response handler
var xhttp = new XMLHttpRequest();
xhttp.timeout = 2000;
xhttp.onreadystatechange = function()
{
	let status_tab=document.getElementById("status_tab");
	if (this.readyState == 4 && this.status == 200)
	{
		if(this.getResponseHeader("Content-Type")!=="application/json")
			return;
		switch(request_mode)
		{
			case mode_enum.opcua_config:
				curr_opcua_config = JSON.parse(this.responseText);
				request_mode = mode_enum.logstats;
				break;
			case mode_enum.logstats:
				let curr_logstats = morfeas_logstat_commonizer(this.responseText);
				//console.log(curr_logstats);
				break;
		}
		data_req=false;
	}
	else if(this.status == 404)
	{
		/*
		status_tab.value = "Error 404: Data Not found";
		status_tab.style.color='red';
		*/
		data_req=false;
	}
};
xhttp.ontimeout = function(){
	/*
	document.getElementById("status_tab").value = "Connection to server: Timeout Error";
	document.getElementById("status_tab").style.color='blue';
	*/
	data_req=false;
};
//timer for get logstats
setInterval(get_data_req, 1000);
function get_data_req()
{
	if(!data_req)
	{
		switch(request_mode)
		{
			case mode_enum.opcua_config:
				xhttp.open("GET", "/morfeas_php/morfeas_web_if.php?COMMAND=opcua_config", true);
				xhttp.send();
				data_req = true;
				break;
			case mode_enum.logstats:
				xhttp.open("GET", "/morfeas_php/morfeas_web_if.php?COMMAND=logstats", true);
				xhttp.send();
				data_req = true;
				break;
		}
	}
}
iso_standard.request_isostandard();//Request ISOstandard from server.
//@license-end
</script>
</html>