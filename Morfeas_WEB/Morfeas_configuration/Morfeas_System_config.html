<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" type="image/x-icon" href="/art/Morfeas_logo_yellow.ico"/>
<link rel="stylesheet" type="text/css" href="Morfeas_System_config.css">
<title>Morfeas WEB</title>
</head>
<body>
<div class="content">
	<table style="margin:auto;text-align:center;margin-bottom:.075in;width:7in;">
	  <tr>
		<th colspan="5" style="font-weight: bold; font-size: xx-large">Morfeas System Configuration</th>
	  </tr>
	</table>
</div>
<div style="width: 100%; overflow: hidden;">
    <div style="width:30%;float:left;">
		<ul id="Comp_UL"></ul>
	</div>
    <div style="width:70%;float:right;">
		<table id="comp_args"></table>
	</div>
</div>
<footer>
  <p>Author: Sam Harry Tzavaras &#169; 12019-12020<br>
  <a href="../LICENSE">License: AGPL v3</a><br>
</footer>
</body>
<script src='../morfeas_ecma/common.js'></script>
<script src='../morfeas_ecma/morfeas_web_if.js'></script>
<script>
"use strict";
if (document.documentMode)
	alert("IE is obsolete, and does not supported \n Use firefox or chromium");
else
{
	var curr_config_xml;
	var comp_args_table = document.getElementById("comp_args");
	function config_list(morfeas_components)
	{
		var listNode=document.getElementById("Comp_UL"),
		comp=morfeas_components.firstChild;
		for(let i = 0; i<morfeas_components.childNodes.length; i++)
		{
		  if(comp.nodeType == Node.ELEMENT_NODE)
		  {
			let comp_name_id;
			if(!(comp_name_id=get_comp_name(comp)))
				continue;
			let textNode = document.createTextNode(comp_name_id),
			liNode = document.createElement("LI");
			liNode.classList.add("caret");
			liNode.addEventListener("click", function()
			{
				var others = document.getElementsByClassName("caret-down");
				for(let j = 0; j<others.length; j++)
					if(others[j] !== this)
					{
						others[j].style.fontWeight = "normal";
						others[j].classList.value = "caret";
					}
				this.classList.value = "caret-down";
				this.style.fontWeight = "bold";
				set_comp_table(comp_args_table, curr_config_xml, this.innerText);
			});
			liNode.appendChild(textNode);
			listNode.appendChild(liNode);
		  }
		  comp = comp.nextSibling;
		}
	}
	//AJAX object for configuration receive and send
	var config=null, xhttp = new XMLHttpRequest();
	xhttp.timeout = 5000;
	xhttp.onreadystatechange = function()
	{
		if (this.readyState == 4 && this.status == 200)
		{
			if(this.getResponseHeader("Content-Type")==="application/xml")
			{
				curr_config_xml = this.responseXML.getElementsByTagName("COMPONENTS")[0];
				config_list(curr_config_xml);
			}
			else
				alert(this.responseText);
		}
	};
	xhttp.ontimeout = function(){
		alert("Communication Error!!!");
	};
	//Get the configuration
	xhttp.open("GET", "../morfeas_php/config.php"+"?COMMAND=getMorfeasConfig", true);
	xhttp.send();
}
</script>
</html>
