<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="shortcut icon" type="image/x-icon" href="Morfeas_logo_yellow.png" />
<title>Morfeas_Web_if_test</title>
</head>
<body>
<table id ="main_menu" style="margin:auto;text-align:center;margin-bottom:.075in;width:7in;">
  <tr>
    <th colspan="7" style="font-size: 200%;">Morfeas_Web_if_test</th>
  </tr>
</table>
<table id ="loggers" style="margin:auto;">
  <tr>
	<td colspan="4"><textarea id="Logger_terminal" style="resize:none;" rows="30" cols="150" readonly></textarea></td>
  </tr>
  <tr>
	<td style="text-align:right;">Logger:
		<select id="logger_select" onchange="request_mode = 1;">
			<option value='0'>None</option>
		</select>
	</td>
  </tr>
</table>
</body>
<script src='morfeas_web_if.js'></script>
<script>
/*    
@licstart  The following is the entire license notice for the 
JavaScript code in this page.

Copyright (C) 12019-12020  Sam Harry Tzavaras

The JavaScript code in this page is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU AGPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.   


@licend  The above is the entire license notice
for the JavaScript code in this page.
*/
var request_mode = 0;
//AJAX responce handler
var xhttp = new XMLHttpRequest();
xhttp.onreadystatechange = function(){
	if (this.readyState == 4 && this.status == 200) 
	{
		switch(request_mode)
		{
			case 0:	
				var Logger_names = JSON.parse(this.responseText);
				var log_select = document.getElementById("logger_select");
				for (i = 0; i < Logger_names.Logger_names.length; i++)
				{
					var opt = document.createElement("option");
					opt.text = Logger_names.Logger_names[i];
					log_select.add(opt); 
				}
				break;
			case 1:
				var Logger_terminal = document.getElementById("Logger_terminal");
				if(Logger_terminal.scrollTop == Logger_terminal.scrollHeight)
				{
					Logger_terminal.innerHTML=this.responseText;
					Logger_terminal.scrollTop = Logger_terminal.scrollHeight;
					console.log("bottom!!!");
				}
				else
					Logger_terminal.innerHTML=this.responseText;
				break;
		}
	}
};
//request names of Loggers
xhttp.open("GET", "morfeas_web_if.php?COMMAND=loggers", true);
xhttp.send();

//main timer
window.setInterval(Morfeas_request, 1000);

function Morfeas_request()
{
	var selected_logger = document.getElementById("logger_select");
	var Logger_terminal = document.getElementById("Logger_terminal");
	if(selected_logger.selectedIndex)
	{
		xhttp.open("GET", "/ramdisk/Morfeas_Loggers/" + selected_logger.value, true);
		xhttp.send();
	}
	else
	{
		Logger_terminal.innerHTML="";
		request_mode = 0;
	}
}

</script>
</html>